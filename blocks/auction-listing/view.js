(()=>{async function e(e,t){const n=await fetch(function(e,t){const n=new URL(e,window.location.origin);return Object.entries(t).forEach(([e,t])=>{null!=t&&(Array.isArray(t)?t.filter(Boolean).forEach(t=>n.searchParams.append(e,String(t))):""!==t&&n.searchParams.set(e,String(t)))}),n.toString()}(e,t),{credentials:"same-origin"});if(!n.ok)throw new Error(`HTTP ${n.status}`);return await n.json()}function t(e){e.querySelectorAll('[data-aucteeno-role="countdown"][data-end]').forEach(e=>{e.textContent=function(e){const t=new Date(e).getTime(),n=Date.now();if(Number.isNaN(t))return"";if(t<=n)return"Ended";const a=Math.floor((t-n)/1e3),o=Math.floor(a/60),r=Math.floor(a/3600),i=Math.floor(a/86400);return i>=2?`${i} days`:1===i?"1 day":r>=2?`${r} hours`:1===r?"1 hour":o>=2?`${o} min`:"1 min"}(e.getAttribute("data-end"))})}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll('[data-aucteeno-kind="auctions"][data-aucteeno-instance]').forEach(n=>{const a=function(e){const t=e.getAttribute("data-aucteeno-state");try{return JSON.parse(t||"{}")}catch{return{}}}(n),o=n.querySelector('[data-aucteeno-role="grid"]'),r=n.querySelector('[data-aucteeno-role="loading"]'),i=n.querySelector('[data-aucteeno-role="location-select"]'),c=e=>{a.isLoading=!!e,r&&(r.hidden=!e),n.classList.toggle("is-loading",!!e)},s={async resetAndLoad(){if(o&&!a.isLoading){c(!0),a.page=1;try{var r,i;const c=await e(a.endpoint,{page:a.page,per_page:a.perPage,sort:a.sort,location:a.locations});a.pages=null!==(r=c.pages)&&void 0!==r?r:1,a.total=null!==(i=c.total)&&void 0!==i?i:0,o.innerHTML=c.html&&c.html.trim()?c.html:`<div class="aucteeno-empty">${a.emptyStateText||"No auctions found."}</div>`,t(n)}catch(e){console.error("Aucteeno auctions resetAndLoad failed",e)}finally{c(!1)}}},async loadNextPage(){if(!o)return;if(a.isLoading)return;if(a.page>=(a.pages||1))return;c(!0);const r=a.page+1;try{var i,s;const c=await e(a.endpoint,{page:r,per_page:a.perPage,sort:a.sort,location:a.locations});a.page=null!==(i=c.page)&&void 0!==i?i:r,a.pages=null!==(s=c.pages)&&void 0!==s?s:a.pages,c.html&&c.html.trim()&&(o.insertAdjacentHTML("beforeend",c.html),t(n))}catch(e){console.error("Aucteeno auctions loadNextPage failed",e)}finally{c(!1)}}};i&&i.addEventListener("change",e=>{const t=e.target.value||"";a.locations=t?[t]:[],s.resetAndLoad()}),function(e){t(e);window.setInterval(()=>t(e),6e4)}(n),function(e,t){const n=e.querySelector('[data-aucteeno-role="sentinel"]');if(!n)return()=>{};new IntersectionObserver(e=>{for(const n of e)n.isIntersecting&&t.loadNextPage()},{rootMargin:"250px"}).observe(n)}(n,s)})})})();